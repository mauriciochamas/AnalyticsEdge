fedFunds <- federalFundsRate
table(fedFunds$Streak>=0)
295/(290+295)
table(fedFunds$Chairman)
fedFunds$Chairman <- as.factor(fedFunds$Chairman)
fedFunds$DemocraticPres <- as.factor(fedFunds$DemocraticPres)
fedFunds$RaisedFedFunds <- as.factor(fedFunds$RaisedFedFunds)
set.seed(201)
library(caTools)
spl <- sample.split(fedFunds$RaisedFedFunds,0.7)
training <- subset(fedFunds,spl==T)
testing <- subset(fedFunds,spl==F)
names(fedFunds)
mod <- glm(RaisedFedFunds~PreviousRate+Streak+Unemployment+HomeownershipRate+DemocraticPres+MonthsUntilElection,data = training,family = "binomial")
summary(mod)
odd <- exp(9.121012 + 1.7*(-0.003427) - 3* 0.157658 + 5.1*(-0.047449) + 65.3*(-0.136451) + 0*0.347829 + 18*(-0.006931) )
pred <- odd/(1+odd)
pred
pred2 <- predict(mod,type = "response",newdata = testing)
table(training$RaisedFedFunds)
table(testing$RaisedFedFunds,pred2>0.5)
library(ROCR)
Rpred <- prediction(pred2,testing$RaisedFedFunds)
as.numeric(performance(Rpred,"auc")@y.values)
Rpred <- prediction(pred2,testing$RaisedFedFunds)
Rperf <- performance(Rpred,"tpr","fpr")
plot(Rperf,colorize=T,print.cutoffs.at=seq(0,1,0.1,),text.adj=c(-0.5,-0.5))
predTest <- predict(log,type = "response", newdata = test)
ROpredTest <- prediction(predTest,test$PoorCare)
Rperf <- performance(ROpredTest,"tpr","fpr")
auc <- as.numeric(performance(ROpredTest,"auc")@y.values)
library(caret)
library(e1071)
library(rpart)
library(randomForest)
library(rpart.plot)
set.seed(201)
numFolds=trainControl(method = "cv",number = 10)
cpGrid <- expand.grid(.cp=seq(0.001,0.05,0.001)) 
train(RaisedFedFunds~PreviousRate+Streak+Unemployment+HomeownershipRate+DemocraticPres+MonthsUntilElection,data=training,method="rpart",trControl=numFolds,tuneGrid=cpGrid)
rai <- rpart(RaisedFedFunds~PreviousRate+Streak+Unemployment+HomeownershipRate+DemocraticPres+MonthsUntilElection,data=training,method="class",cp=0.016)
prp(rai)
pre <- predict(rai,newdata = testing, type = "class")
table(testing$RaisedFedFunds,pre)
112/nrow(testing)
